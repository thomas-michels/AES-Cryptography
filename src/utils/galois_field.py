
class GaloisField:

    l_table = {
        "0": {"0": "00", "1": "00", "2": "19", "3": "01", "4": "32", "5": "02", "6": "1a", "7": "c6", "8": "4b", "9": "c7", "A": "1b", "B": "68", "C": "33", "D": "ee", "E": "df", "F": "03"},
        "1": {"0": "64", "1": "04", "2": "e0", "3": "0e", "4": "34", "5": "8d", "6": "81", "7": "ef", "8": "4c", "9": "71", "A": "08", "B": "c8", "C": "f8", "D": "69", "E": "1c", "F": "c1"},
        "2": {"0": "7d", "1": "c2", "2": "1d", "3": "b5", "4": "f9", "5": "b9", "6": "27", "7": "6a", "8": "4d", "9": "e4", "A": "a6", "B": "72", "C": "9a", "D": "c9", "E": "09", "F": "78"},
        "3": {"0": "65", "1": "2f", "2": "8a", "3": "05", "4": "21", "5": "0f", "6": "e1", "7": "24", "8": "12", "9": "f0", "A": "82", "B": "45", "C": "35", "D": "93", "E": "da", "F": "8e"},
        "4": {"0": "96", "1": "8f", "2": "db", "3": "bd", "4": "36", "5": "d0", "6": "ce", "7": "94", "8": "13", "9": "5c", "A": "d2", "B": "f1", "C": "40", "D": "46", "E": "83", "F": "38"},
        "5": {"0": "66", "1": "dd", "2": "fd", "3": "30", "4": "bf", "5": "06", "6": "8b", "7": "62", "8": "b3", "9": "25", "A": "e2", "B": "98", "C": "22", "D": "88", "E": "91", "F": "10"},
        "6": {"0": "7e", "1": "6e", "2": "48", "3": "c3", "4": "a3", "5": "b6", "6": "1e", "7": "42", "8": "3a", "9": "6b", "A": "28", "B": "54", "C": "fa", "D": "85", "E": "3d", "F": "ba"},
        "7": {"0": "2b", "1": "79", "2": "0a", "3": "15", "4": "9b", "5": "9f", "6": "5e", "7": "ca", "8": "4e", "9": "d4", "A": "ac", "B": "e5", "C": "f3", "D": "73", "E": "a7", "F": "57"},
        "8": {"0": "af", "1": "58", "2": "a8", "3": "50", "4": "f4", "5": "ea", "6": "d6", "7": "74", "8": "4f", "9": "ae", "A": "e9", "B": "d5", "C": "e7", "D": "e6", "E": "ad", "F": "e8"},
        "9": {"0": "2c", "1": "d7", "2": "75", "3": "7a", "4": "eb", "5": "16", "6": "0b", "7": "f5", "8": "59", "9": "cb", "A": "5f", "B": "b0", "C": "9c", "D": "a9", "E": "51", "F": "a0"},
        "A": {"0": "7f", "1": "0c", "2": "f6", "3": "6f", "4": "17", "5": "c4", "6": "49", "7": "ec", "8": "d8", "9": "43", "A": "1f", "B": "2d", "C": "a4", "D": "76", "E": "7b", "F": "b7"},
        "B": {"0": "cc", "1": "bb", "2": "3e", "3": "5a", "4": "fb", "5": "60", "6": "b1", "7": "86", "8": "3b", "9": "52", "A": "a1", "B": "6c", "C": "aa", "D": "55", "E": "29", "F": "9d"},
        "C": {"0": "97", "1": "b2", "2": "87", "3": "90", "4": "61", "5": "be", "6": "dc", "7": "fc", "8": "bc", "9": "95", "A": "cf", "B": "cd", "C": "37", "D": "3f", "E": "5b", "F": "d1"},
        "D": {"0": "53", "1": "39", "2": "84", "3": "3c", "4": "41", "5": "a2", "6": "6d", "7": "47", "8": "14", "9": "2a", "A": "9e", "B": "5d", "C": "56", "D": "f2", "E": "d3", "F": "ab"},
        "E": {"0": "44", "1": "11", "2": "92", "3": "d9", "4": "23", "5": "20", "6": "2e", "7": "89", "8": "b4", "9": "7c", "A": "b8", "B": "26", "C": "77", "D": "99", "E": "e3", "F": "a5"},
        "F": {"0": "67", "1": "4a", "2": "ed", "3": "de", "4": "c5", "5": "31", "6": "fe", "7": "18", "8": "0d", "9": "63", "A": "8c", "B": "80", "C": "c0", "D": "f7", "E": "70", "F": "07"},
    }

    e_table = {
        "0": {"0": "01", "1": "03", "2": "05", "3": "0f", "4": "11", "5": "33", "6": "55", "7": "ff", "8": "1a", "9": "2e", "A": "72", "B": "96", "C": "a1", "D": "f8", "E": "13", "F": "35"},
        "1": {"0": "5f", "1": "e1", "2": "38", "3": "48", "4": "d8", "5": "73", "6": "95", "7": "a4", "8": "f7", "9": "02", "A": "06", "B": "0a", "C": "1e", "D": "22", "E": "66", "F": "aa"},
        "2": {"0": "e5", "1": "34", "2": "5c", "3": "e4", "4": "37", "5": "59", "6": "eb", "7": "26", "8": "6a", "9": "be", "A": "d9", "B": "70", "C": "90", "D": "ab", "E": "e6", "F": "31"},
        "3": {"0": "53", "1": "f5", "2": "04", "3": "0c", "4": "14", "5": "3c", "6": "44", "7": "cc", "8": "4f", "9": "d1", "A": "68", "B": "b8", "C": "d3", "D": "6e", "E": "b2", "F": "cd"},
        "4": {"0": "4c", "1": "d4", "2": "67", "3": "a9", "4": "e0", "5": "3b", "6": "4d", "7": "d7", "8": "62", "9": "a6", "A": "f1", "B": "08", "C": "18", "D": "28", "E": "78", "F": "88"},
        "5": {"0": "83", "1": "9e", "2": "b9", "3": "d0", "4": "6b", "5": "bd", "6": "dc", "7": "7f", "8": "81", "9": "98", "A": "b3", "B": "ce", "C": "49", "D": "db", "E": "76", "F": "9a"},
        "6": {"0": "b5", "1": "c4", "2": "57", "3": "f9", "4": "10", "5": "30", "6": "50", "7": "f0", "8": "0b", "9": "1d", "A": "27", "B": "69", "C": "bb", "D": "d6", "E": "61", "F": "a3"},
        "7": {"0": "fe", "1": "19", "2": "2b", "3": "7d", "4": "87", "5": "92", "6": "ad", "7": "ec", "8": "2f", "9": "71", "A": "93", "B": "ae", "C": "e9", "D": "20", "E": "60", "F": "a0"},
        "8": {"0": "fb", "1": "16", "2": "3a", "3": "4e", "4": "d2", "5": "6d", "6": "b7", "7": "c2", "8": "5d", "9": "e7", "A": "32", "B": "56", "C": "fa", "D": "15", "E": "3f", "F": "41"},
        "9": {"0": "c3", "1": "5e", "2": "e2", "3": "3d", "4": "47", "5": "c9", "6": "40", "7": "c0", "8": "5b", "9": "ed", "A": "2c", "B": "74", "C": "9c", "D": "bf", "E": "da", "F": "75"},
        "A": {"0": "9f", "1": "ba", "2": "d5", "3": "64", "4": "ac", "5": "ef", "6": "2a", "7": "7e", "8": "82", "9": "9d", "A": "bc", "B": "df", "C": "7a", "D": "8e", "E": "89", "F": "80"},
        "B": {"0": "9b", "1": "b6", "2": "c1", "3": "58", "4": "e8", "5": "23", "6": "65", "7": "af", "8": "ea", "9": "25", "A": "6f", "B": "b1", "C": "c8", "D": "43", "E": "c5", "F": "54"},
        "C": {"0": "fc", "1": "1f", "2": "21", "3": "63", "4": "a5", "5": "f4", "6": "07", "7": "09", "8": "1b", "9": "2d", "A": "77", "B": "99", "C": "b0", "D": "cb", "E": "46", "F": "ca"},
        "D": {"0": "45", "1": "cf", "2": "4a", "3": "de", "4": "79", "5": "8b", "6": "86", "7": "91", "8": "a8", "9": "e3", "A": "3e", "B": "42", "C": "c6", "D": "51", "E": "f3", "F": "0e"},
        "E": {"0": "12", "1": "36", "2": "5a", "3": "ee", "4": "29", "5": "7b", "6": "8d", "7": "8c", "8": "8f", "9": "8a", "A": "85", "B": "94", "C": "a7", "D": "f2", "E": "0d", "F": "17"},
        "F": {"0": "39", "1": "4b", "2": "dd", "3": "7c", "4": "84", "5": "97", "6": "a2", "7": "fd", "8": "1c", "9": "24", "A": "6c", "B": "b4", "C": "c7", "D": "52", "E": "f6", "F": "01"},
    }

    def multiply(self, most_significant: str, less_significant: str) -> str:
        most_significant, less_significant = most_significant.zfill(2), less_significant.zfill(2)

        if most_significant == "00" or less_significant == "00":
            return "00"

        if most_significant == "01":
            return less_significant

        if less_significant == "01":
            return most_significant

        most_significant_char, less_significant_char = list(most_significant), list(less_significant)

        first_term = self.l_table[most_significant_char[0]][most_significant_char[1]].upper()
        second_term = self.l_table[less_significant_char[0]][less_significant_char[1]].upper()
        
        result = hex(int(first_term, 16) + int(second_term, 16))
        result = result.replace("0x", "").upper().zfill(2)
        if int(result, 16) > int("FF", 16):
            result = hex(int(result, 16) % 255).replace("0x", "").upper().zfill(2)
            
        result_char = list(result)
        return self.e_table[result_char[0]][result_char[1]].upper()
